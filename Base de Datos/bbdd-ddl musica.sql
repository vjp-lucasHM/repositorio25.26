-- --------- 
-- BBDD
-- DB MUSICA
-- LUCAS HERRERA MORENO
-- ----------
DROP DATABASE MUSICA;

CREATE DATABASE IF NOT EXISTS MUSICA;
USE MUSICA;


DROP TABLE GRUPO;

CREATE TABLE GRUPOS(
	NUM_GRUPO INT NOT NULL PRIMARY KEY,
    NOMBRE VARCHAR(100),
    AÑO_CREACION INT
);

CREATE TABLE INTEGRANTES(
	NUM_INTEGRANTE INT NOT NULL PRIMARY KEY,
    NUM_GRUPO INT NOT NULL,
    NOMBRE VARCHAR(100),
	APELLIDOS VARCHAR(100),
    AÑO_NACIMIENTO INT
);

CREATE TABLE DISCOS(
	NUM_DISCO INT NOT NULL PRIMARY KEY,
    NUM_GRUPO INT NOT NULL,
    TITULO VARCHAR(100),
    AÑO_CREACION INT
);

CREATE TABLE CANCIONES(
	NUM_GRUPO INT NOT NULL,
    NUM_DISCO INT NOT NULL,
    NUM_CANCION INT NOT NULL,
    TITULO VARCHAR(100),
    DURACION TIME
);

ALTER TABLE CANCIONES MODIFY NUM_CANCION INT NOT NULL PRIMARY KEY;

ALTER TABLE INTEGRANTES ADD CONSTRAINT GRU_FK FOREIGN KEY(NUM_GRUPO) REFERENCES GRUPOS(NUM_GRUPO) ON DELETE CASCADE ON UPDATE CASCADE;

DESC INTEGRANTES;

ALTER TABLE DISCOS ADD CONSTRAINT GRU2_FK FOREIGN KEY(NUM_GRUPO) REFERENCES GRUPOS(NUM_GRUPO) ON DELETE CASCADE ON UPDATE CASCADE;

DESC DISCOS;

ALTER TABLE CANCIONES ADD CONSTRAINT GRU3_FK FOREIGN KEY(NUM_GRUPO) REFERENCES GRUPOS(NUM_GRUPO) ON DELETE CASCADE ON UPDATE CASCADE,
						ADD CONSTRAINT DIS_FK FOREIGN KEY(NUM_DISCO) REFERENCES DISCOS(NUM_DISCO) ON DELETE CASCADE ON UPDATE CASCADE;

INSERT INTO GRUPOS VALUES
	(1, 'Queen', 1970),
    (2, 'Coldplay', 1997);
    
INSERT INTO INTEGRANTES VALUES
	(1, 1, 'Freddie', 'Mercury', 1946),
	(2, 1, 'Brian', 'May', 1947),
	(3, 1, 'Roger', 'Taylor', 1949),
	(4, 2, 'Chris', 'Martin', 1977),
	(5, 2, 'Jonny', 'Buckland', 1977),
	(6, 2, 'Guy', 'Berryman', 1978);
    
INSERT INTO DISCOS VALUES
	(1, 1, 'A Night at the Opera', 1975),
	(2, 1, 'News of the World', 1977),
	(3, 1, 'The Game', 1980),
	(4, 2, 'Parachutes', 2000),
	(5, 2, 'A Rush of Blood to the Head', 2002),
	(6, 2, 'Viva la Vida', 2008);
    
INSERT INTO CANCIONES VALUES
	(1, 1, 1, 'Bohemian Rhapsody', '00:05:55'),
	(1, 1, 2, 'Love of My Life', '00:03:38'),
	(1, 2, 1, 'We Will Rock You', '00:02:02'),
	(1, 3, 1, 'Another One Bites the Dust', '00:03:35'),
	(2, 4, 1, 'Yellow', '00:04:29'),
	(2, 5, 1, 'Clocks', '00:05:07'),
	(2, 6, 1, 'Viva la Vida', '00:04:02');